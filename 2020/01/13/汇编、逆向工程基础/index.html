

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.png">
  <link rel="icon" href="/img/logo.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Mr.BelieVe">
  <meta name="keywords" content="">
  
  <title>汇编、逆向工程基础 - Mr.BelieVe&#39;s Treasure</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","version":"1.8.9-a","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Mr.BelieVe's Treasure" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Mr.BelieVe's Treasure</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="汇编、逆向工程基础">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-01-13 23:05" pubdate>
        2020年1月13日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      47
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">汇编、逆向工程基础</h1>
            
            <div class="markdown-body">
              <p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_21508727/article/details/80559270">https://blog.csdn.net/qq_21508727/article/details/80559270</a></p>
<h2 id="单位"><a href="#单位" class="headerlink" title="单位"></a>单位</h2><blockquote>
<ol>
<li>·WORD（字） - 一个字由两个字节组成，共有16位。一个字的最大值是0FFFFh (或者是 65535d) (h代表16进制，d代表10进制)。</li>
<li>·DOUBLE WORD（双字DWORD） - 一个双字包含两个字，共有32位。最大值为0FFFFFFFF (或者是 4294967295d)。</li>
</ol>
<blockquote>
<p>一个16进制占4bit</p>
</blockquote>
</blockquote>
<h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><p>Win+Intel CPU组成的计算机通常有9个32位寄存器 (w/o 标志寄存器)。它们是：</p>
<blockquote>
<ol>
<li>EAX： 累加器</li>
<li>EBX： 基址寄存器</li>
<li>ECX： 计数器</li>
<li>EDX： 数据寄存器</li>
<li>ESI： 源变址寄存器</li>
<li>EDI： 目的变址寄存器</li>
<li>EBP： 扩展基址指针寄存器</li>
<li>ESP： 栈指针寄存器</li>
<li>EIP： 指令指针寄存器</li>
</ol>
<blockquote>
<p>==大小都是4个字节==</p>
<blockquote>
<ol>
<li><p>EBP： EBP在栈中运用最广，刚开始没有什么需要特别注意的 ;) </p>
</li>
<li><p>ESP： ESP指向栈区域的栈顶位置。栈是一个存放即将会被用到的数据的地方，你可以去搜索一下push/pop 指令了解更多栈知识。 </p>
</li>
<li><p>EIP： EIP指向下一个将会被执行的指令。</p>
</li>
</ol>
<hr>
<p><strong>栈（stack）：后进先出的数据结构</strong>     </p>
<p><strong>堆（heap）：经过排列的树形数据结构，通常指二叉堆，存取是随意的</strong></p>
</blockquote>
</blockquote>
</blockquote>
<p>有一些寄存器是16位甚至8位的，是不能直接寻址的。</p>
<blockquote>
<img src="/2020/01/13/%E6%B1%87%E7%BC%96%E3%80%81%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%9F%BA%E7%A1%80/1565342053303.png" srcset="/img/loading.gif" lazyload class="" width="1565342053303">
</blockquote>
<p>一个寄存器可以这样看：</p>
<img src="/2020/01/13/%E6%B1%87%E7%BC%96%E3%80%81%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%9F%BA%E7%A1%80/1565342088084.png" srcset="/img/loading.gif" lazyload class="" width="1565342088084">

<p>EAX是名字，AX是低16位部分，又分为低8位AL，高8位AH</p>
<p><strong>了解：</strong></p>
<p>i.单字节（8位）寄存器：</p>
<blockquote>
<ol>
<li>AL and AH</li>
<li>BL and BH</li>
<li>CL and CH</li>
<li>DL and DH</li>
</ol>
</blockquote>
<p>ii.单字（16位）寄存器：这些寄存器大小为一个字（=2字节=16位）。一个单字寄存器包含两个单字节寄存器。通常根据功能区分</p>
<p>1.通用寄存器:</p>
<blockquote>
<ol>
<li>AX (单字=16位) = AH + AL -&gt; 其中‘+’号并不代表把它们代数相加。AH和AL寄存器是相互独立的，只不过都是AX寄存器的一部分，所以你改变AH或AL (或者都改变) ，AX寄存器也会被改变。 </li>
<li>-&gt; ‘accumulator’(累加器)：用于进行数学运算</li>
<li>BX -&gt; ‘base’(基址寄存器)：用来连接栈(之后会说明)</li>
<li>CX -&gt; ‘counter’(计数器)：</li>
<li>DX -&gt; ‘data’(数据寄存器)：大多数情况下用来存放数据</li>
<li>DI -&gt; ‘destination index’(目的变址寄存器): 例如将一个字符串拷贝到DI</li>
<li>SI -&gt; ‘source index’(源变址寄存器): 例如将一个字符串从SI拷贝</li>
</ol>
</blockquote>
<p>2.索引寄存器（指针寄存器）:</p>
<blockquote>
<ol>
<li>BP -&gt; ‘base pointer’(基址指针寄存器)：表示栈区域的基地址</li>
<li>SP -&gt; ‘stack pointer’(栈指针寄存器)：表示栈区域的栈顶地址</li>
</ol>
</blockquote>
<p>3.段寄存器：</p>
<blockquote>
<ol>
<li>CS -&gt; ‘code segment’(代码段寄存器)：用于存放应用程序代码所在段的段基址(之后会说明)</li>
<li>DS -&gt; ‘data segment’(数据段寄存器)：用于存放数据段的段基址(以后会说明)</li>
<li>ES -&gt; ‘extra segment’(附加段寄存器)：用于存放程序使用的附加数据段的基地址</li>
<li>SS -&gt; ‘stack segment’(栈段寄存器)：用于存放栈段的段基址(以后会说明)</li>
</ol>
</blockquote>
<p>4.指令指针寄存器：</p>
<blockquote>
<p>IP -&gt; ‘instruction pointer’(指令指针寄存器)：指向下一个指令 ;)</p>
</blockquote>
<p>iii. 双字(32位)寄存器：</p>
<p>2 字= 4 字节= 32 位， EAX、EBX、ECX、EDX、EDI…… </p>
<p>如果16位寄存器前面加了‘E’，就代表它们是32位寄存器。例如，AX=16位，EAX=32位。</p>
<h2 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h2><p>32位的CPU中有32个不同的标志寄存器，只关心期中三个：ZF、OF、CF。标志寄存器是一个标志，==只能是0或者1，决定了是否要执行某个指令==，可以知道程序在这一步是否会跳转。</p>
<h3 id="Z-Flag（零标志）"><a href="#Z-Flag（零标志）" class="headerlink" title="Z-Flag（零标志）"></a>Z-Flag（零标志）</h3><p>ZF是破解中用的最多的寄存器（通常90%）。若上一个运算结果为0，则值为1，否则为0。</p>
<h3 id="The-O-Flag（溢出标志）"><a href="#The-O-Flag（溢出标志）" class="headerlink" title="The O-Flag（溢出标志）"></a>The O-Flag（溢出标志）</h3><p>OF占约4%，若上一步改变了某寄存器的最高有效位，则会被设置为1。操作产生溢出时也会被设置为1。</p>
<h3 id="The-C-Flag（进位标志）"><a href="#The-C-Flag（进位标志）" class="headerlink" title="The C-Flag（进位标志）"></a>The C-Flag（进位标志）</h3><p>CF占1%，产生溢出，就会被设置为1。</p>
<h2 id="段偏移"><a href="#段偏移" class="headerlink" title="段偏移"></a>段偏移</h2><p>内存中的一个段储存了指令（CS）、数据（DS）、堆栈（SS）或者其他段（ES）。每一个段都有一个偏移量，在32位应用程序下，这些偏移量由00000000到FFFFFFFF。段和偏移量的标准形式如下：</p>
<blockquote>
<p>段：偏移量 = 把它们放在一起就是内存中一个具体的地址。</p>
<p>比喻：一个段是一本书的某一页；偏移量是一页的某一行。</p>
</blockquote>
<h2 id="堆和栈"><a href="#堆和栈" class="headerlink" title="堆和栈"></a>堆和栈</h2><p><strong>内存中的栈区处于相对较高的地址以地址的增长方向为上的话，栈地址是向下增长的。</strong></p>
<p>栈中分配局部变量空间，堆区是向上增长的用于分配程序员申请的内存空间。另外还有静态区是分配静态变量，全局变量空间的；只读区是分配常量和程序代码空间的；以及其他一些分区。</p>
<blockquote>
<p>PUSH 命令是向栈中压入数据，POP命令就是从栈中取出最后放入的数据并且把它存进具体的寄存器中。</p>
</blockquote>
<h3 id="1、堆和栈申请和回收方式不同"><a href="#1、堆和栈申请和回收方式不同" class="headerlink" title="1、堆和栈申请和回收方式不同"></a>1、堆和栈申请和回收方式不同</h3><ul>
<li>栈：由系统自动分配空间，自动回收</li>
<li>堆：由程序员自己申请空间，不释放就可以一直访问</li>
</ul>
<h3 id="2、申请后系统响应"><a href="#2、申请后系统响应" class="headerlink" title="2、申请后系统响应"></a>2、申请后系统响应</h3><ul>
<li>栈：只要栈剩余空间,就自动分配空间，否则提示栈溢出</li>
<li>堆：==操作系统有一个记录空闲内存地址的链表==，系统收到空间申请会遍历该链表，寻找第一个大于申请空间的结点。并将结点从空闲结点链表删除，将空间分配给程序。==在这块内存空间的首地址会记录分配空间的大小，所以delete才能正确释放空间。==多余空间会放回空闲链表。 </li>
</ul>
<h3 id="3、堆申请效率比栈低"><a href="#3、堆申请效率比栈低" class="headerlink" title="3、堆申请效率比栈低"></a>3、堆申请效率比栈低</h3><h3 id="4、申请大小的限制"><a href="#4、申请大小的限制" class="headerlink" title="4、申请大小的限制"></a>4、申请大小的限制</h3><ul>
<li>栈：Win下，栈是==连续的内存区域==，==向低地址扩展的数据结构。栈顶地址和栈的最大容量是系统预先规定好的。==Win下栈大小为1M，申请空间超出剩余会提示overflow。</li>
<li>堆：向高地址拓展的数据结构，不连续的内存区域。（因为用链表储存）<strong>链表遍历从低地址到高地址。</strong>堆的大小受限于计算机系统中有效的虚拟内存。</li>
</ul>
<h3 id="5、堆和栈中的存储内容"><a href="#5、堆和栈中的存储内容" class="headerlink" title="5、堆和栈中的存储内容"></a>5、堆和栈中的存储内容</h3><ul>
<li>栈大小有限，用子函数有物理意义（？？？）</li>
<li>栈：调用函数时，第一个进栈的是主函数中函数调用后的下一条指令（下一条可执行语句）==的地址==，然后是函数的各个参数，在大多数C编译器中，参数是由右往左入栈的，然后是函数中的局部变量。==静态变量不入栈。==</li>
</ul>
<p>==调用结束后，局部变量先出栈，然后是参数，最后栈顶指向最开始存的地址，也就是主函数中的下一条指令，程序由该点继续运行==</p>
<ul>
<li>堆:一般是在堆的头部用一个字节存放堆的大小。堆中具体内容由程序员安排。</li>
</ul>
<h3 id="6、存取效率的比较"><a href="#6、存取效率的比较" class="headerlink" title="6、存取效率的比较"></a>6、存取效率的比较</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">char</span> s1[] = <span class="hljs-string">&quot;aaaaaaaaaaaaaaa&quot;</span>; <br><span class="hljs-keyword">char</span> *s2 = <span class="hljs-string">&quot;bbbbbbbbbbbbbbbbb&quot;</span>; <br></code></pre></td></tr></table></figure>

<p>aaaaaaaaaaa是在运行时刻赋值的；（字符数组有连续空间存放值）放在栈中。<br>而bbbbbbbbbbb是在编译时就确定的；（只有4字节的空间用于存放地址）放在堆中。<br>==在以后的存取中，在栈上的数组比指针所指向的字符串(例如堆)快==</p>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><p>==所有值通常以16进制形式储存的。==</p>
<p>大部分指令有两个操作符（例如add EAX,EBX）,有些是一个（例如not EAX），还有一些是三个操作符（例如IMUL EAX，EDX，64）。如果使用“DWORD PTR [XXX]”就表示使用了内存中偏移量为XXX的数据。<strong>Win+Intel的电脑大多采用“低尾端法”，所以字节在内存中储存方式是倒过来的。</strong></p>
<blockquote>
<p>大部分有两个操作符的指令都是以下这种格式（以add举例）</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span>                           寄存器, 寄存器<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">123</span>                           寄存器, 数值<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-number">404000</span>]            寄存器, <span class="hljs-built_in">Dword</span>  指针 [数值]<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">eax</span>]               寄存器, <span class="hljs-built_in">Dword</span>  指针 [寄存器值]<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">eax</span>+<span class="hljs-number">00404000</span>]      寄存器, <span class="hljs-built_in">Dword</span>  指针 [寄存器值+数值]<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-number">404000</span>],<span class="hljs-built_in">eax</span>            <span class="hljs-built_in">Dword</span> 指针[数值], 寄存器<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-number">404000</span>],<span class="hljs-number">123</span>            <span class="hljs-built_in">Dword</span> 指针[数值], 数值<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">eax</span>],<span class="hljs-built_in">eax</span>               <span class="hljs-built_in">Dword</span> 指针[寄存器值], 寄存器<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">eax</span>],<span class="hljs-number">123</span>               <span class="hljs-built_in">Dword</span> 指针[寄存器值], 数值<br>&gt;<span class="hljs-keyword">add</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">eax</span>+<span class="hljs-number">404000</span>],<span class="hljs-built_in">eax</span>        <span class="hljs-built_in">Dword</span> 指针[寄存器值+数值], 寄存器<span class="hljs-keyword">add</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">eax</span>+<span class="hljs-number">404000</span>],<span class="hljs-number">123</span>        <span class="hljs-built_in">Dword</span> 指针[寄存器值+数值], 数值<br></code></pre></td></tr></table></figure>
</blockquote>
<h3 id="ADD"><a href="#ADD" class="headerlink" title="ADD"></a>ADD</h3><p>ADD 被加数，加数</p>
<p>将一个数值加在一个寄存器上或者一个内存地址上。</p>
<p>add eax,123 == eax = eax +123</p>
<p>加法指令对ZF，OF，CF都有影响</p>
<h3 id="AND"><a href="#AND" class="headerlink" title="AND"></a>AND</h3><p>AND 目标数，原数</p>
<p>AND运算对两个数进行逻辑与运算。</p>
<p>会清空OF,CF标记，设置ZF标记。</p>
<h3 id="CALL"><a href="#CALL" class="headerlink" title="CALL"></a>CALL</h3><blockquote>
<p>CALL 404000                 最常见: CALL 地址<br>CALL EAX                    CALL 寄存器 - 如果寄存器存的值为404000，那就等同于第一种情况<br>CALL DWORD PTR [EAX]        CALL [EAX]偏移量所指向的地址<br>CALL DWORD PTR [EAX+5]      CALL [EAX+5]偏移量所指向的地址</p>
</blockquote>
<h3 id="CDQ"><a href="#CDQ" class="headerlink" title="==CDQ=="></a>==CDQ==</h3><p>通常出现在除法前面，将EDX的所有位变成EAX最高位的值</p>
<p>比如当EAX&gt;=80000000h时，其二进制最高位为1，则EDX被32位全赋值为1，即FFFFFFFF</p>
<p>若EAX&lt;80000000，则其二进制最高位为0，EDX为00000000。</p>
<p>然后将EDX：EAX组成新数(64位)：FFFFFFFF 80000000</p>
<h3 id="CMP（compare）"><a href="#CMP（compare）" class="headerlink" title="CMP（compare）"></a>CMP（compare）</h3><p>CMP 目标数，原数</p>
<p>比较两个值并且标记CF、OF、ZF:</p>
<blockquote>
<p>CMP     EAX, EBX               比较eax和ebx是否相等，如果相等就设置ZF为1<br>CMP     EAX,[404000]           比较eax和偏移量为[404000]的值是否相等<br>CMP     [404000],EAX           比较[404000]是否与eax相等</p>
</blockquote>
<h3 id="DEC-decrease"><a href="#DEC-decrease" class="headerlink" title="DEC(decrease)"></a>DEC(decrease)</h3><p>DEC something</p>
<p>自减</p>
<blockquote>
<p>dec eax                              eax自减1<br>dec [eax]                            偏移量为eax的值自减1<br>dec [401000]                         偏移量为401000的值自减1<br>dec [eax+401000]                     偏移量为eax+401000的值自减1</p>
</blockquote>
<p>可以标记ZF、OF</p>
<h3 id="DIV（division除）"><a href="#DIV（division除）" class="headerlink" title="DIV（division除）"></a>DIV（division除）</h3><p>DIV 除数</p>
<p>无符号除法</p>
<p>DIV指令用来将EAX除以除数（无符号除法），被除数通常是EAX，结果也储存在EAX中，而被除数对除数取的模存在除数中。</p>
<blockquote>
<p>mov eax,64                       EAX = 64h = 100<br>mov ecx,9                        ECX = 9<br>div ecx                          EAX除以ECX</p>
</blockquote>
<p>EAX = 100/9 = 0B(11)并且ECX = 100 MOD 9 = 1</p>
<p>可以标记CF、OF、ZF</p>
<h3 id="IDIV（整除）"><a href="#IDIV（整除）" class="headerlink" title="IDIV（整除）"></a>IDIV（整除）</h3><p>IDIV 除数</p>
<p>有符号除法</p>
<p>执行方法同div一样</p>
<h3 id="INC（increase）"><a href="#INC（increase）" class="headerlink" title="INC（increase）"></a>INC（increase）</h3><p>自加</p>
<p>可以标记ZF、OF</p>
<p><strong>INT</strong></p>
<p>语法: int 目标数</p>
<p>INT 的目标数必须是产生一个整数(例如：int 21h)，类似于call调用函数，INT指令是调用程序对硬件控制，不同的值对应着不同的功能。</p>
<p>具体参照硬件说明书。</p>
<p><strong>JUMPS</strong></p>
<p>这些都是最重要的跳转指令和触发条件(重要用<em>标记，最重要用*</em>标记)：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs routeros">指令                条件                    条件<br>JA*          -    如果大于就跳转(无符号)      - <span class="hljs-attribute">CF</span>=0 <span class="hljs-keyword">and</span> <span class="hljs-attribute">ZF</span>=0<br>JAE          -    如果大于或等于就跳转(无符号)- <span class="hljs-attribute">CF</span>=0<br>JB*          -    如果小于就跳转(无符号)   - <span class="hljs-attribute">CF</span>=1<br>JBE          -    如果小于或等于就跳转(无符号)- <span class="hljs-attribute">CF</span>=1 <span class="hljs-keyword">or</span> <span class="hljs-attribute">ZF</span>=1<br>JC           -    如果CF被标记就了跳转       - <span class="hljs-attribute">CF</span>=1<br>JCXZ         -    如果CX等于0就跳转      - <span class="hljs-attribute">CX</span>=0<br>JE**         -    如果相等就跳转        - <span class="hljs-attribute">ZF</span>=1<br>JECXZ        -    如果ECX等于0就跳转       - <span class="hljs-attribute">ECX</span>=0<br>JG*          -    如果大于就跳转(有符号)   - <span class="hljs-attribute">ZF</span>=0 <span class="hljs-keyword">and</span> <span class="hljs-attribute">SF</span>=OF (SF = Sign Flag)<br>JGE*         -    如果大于或等于就跳转(有符号) - <span class="hljs-attribute">SF</span>=OF<br>JL*          -    如果小于就跳转(有符号)    - SF != OF (!= is <span class="hljs-keyword">not</span>)<br>JLE*         -    如果小于或等于就跳转(有符号 - <span class="hljs-attribute">ZF</span>=1 <span class="hljs-keyword">and</span> OF != OF<br>JMP**        -    跳转             - 强制跳转<br>JNA          -    如果不大于就跳转(无符号)   - <span class="hljs-attribute">CF</span>=1 <span class="hljs-keyword">or</span> <span class="hljs-attribute">ZF</span>=1<br>JNAE         -    如果不大于等于就跳转(无符号) - <span class="hljs-attribute">CF</span>=1<br>JNB          -    如果不小于就跳转(无符号)   - <span class="hljs-attribute">CF</span>=0<br>JNBE         -    如果不小于等于就跳转(无符号) - <span class="hljs-attribute">CF</span>=0 <span class="hljs-keyword">and</span> <span class="hljs-attribute">ZF</span>=0<br>JNC          -    如果CF未被标记就跳转     - <span class="hljs-attribute">CF</span>=0<br>JNE**        -    如果不等于就跳转       - <span class="hljs-attribute">ZF</span>=0<br>JNG          -    如果不大于就跳转(有符号)   - <span class="hljs-attribute">ZF</span>=1 <span class="hljs-keyword">or</span> SF!=OF<br>JNGE         -    如果不大于等于就跳转(有符号) - SF!=OF<br>JNL          -    如果不小于就跳转(有符号)   - <span class="hljs-attribute">SF</span>=OF<br>JNLE         -    如果不小于等于就跳转(有符号) - <span class="hljs-attribute">ZF</span>=0 <span class="hljs-keyword">and</span> <span class="hljs-attribute">SF</span>=OF<br>JNO          -    如果OF未被标记就跳转     - <span class="hljs-attribute">OF</span>=0<br>JNP          -    如果PF未被标记就跳转     - <span class="hljs-attribute">PF</span>=0<br>JNS          -    如果SF未被标记就跳转      - <span class="hljs-attribute">SF</span>=0<br>JNZ          -    如果不等于0就跳转      - <span class="hljs-attribute">ZF</span>=0<br>JO           -    如果OF被标记就跳转     - <span class="hljs-attribute">OF</span>=1<br>JP           -    如果PF被标记就跳转     - <span class="hljs-attribute">PF</span>=1<br>JPE          -    如果是偶数就跳转       - <span class="hljs-attribute">PF</span>=1<br>JPO          -    如果是奇数就跳转       - <span class="hljs-attribute">PF</span>=0<br>JS           -    如果SF被标记就跳转     - <span class="hljs-attribute">SF</span>=1<br>JZ           -    如果等于0就跳转      - <span class="hljs-attribute">ZF</span>=1<br></code></pre></td></tr></table></figure>

<p><strong>LEA (有效地址传送)</strong></p>
<p>语法：LEA 目的数、源数</p>
<p>LEA可以看成和MOV差不多的指令LEA ，它本身的功能并没有被太广泛的使用，反而广泛运用在快速乘法中：</p>
<p>lea eax，dword ptr [4*ecx+ebx]</p>
<p>将eax赋值为 4*ecx+ebx</p>
<p><strong>MOV (传送)</strong></p>
<p>语法: MOV 目的数,源数</p>
<p>这是一个很简单的指令，MOV指令将源数赋值给目的数，并且源数值保持不变</p>
<p>这里有一些MOV的变形：</p>
<p>MOVS/MOVSB/MOVSW/MOVSD EDI, ESI：这些变形能将ESI指向的内容传送到EDI指向的内容中去</p>
<p>MOVSX：MOVSX指令将单字或者单字节扩展为双字或者双字节传送，原符号不变</p>
<p>MOVZX：MOVZX扩展单字节或单字为双字节或双字并且用0填充剩余部分(通俗来说就是将源数取出置于目的数，其他位用0填充)</p>
<p><strong>MUL (multiply乘法)</strong></p>
<p>语法：MUL 数值</p>
<p>这个指令同IMUL一样，不过MUL可以乘无符号数。</p>
<p><strong>NOP (无操作)</strong></p>
<p>语法：NOP</p>
<p>这个指令说明不做任何事</p>
<p>所以它在逆向中运用范围最广</p>
<p><strong>OR (逻辑或)</strong></p>
<p>语法：OR 目的数,源数</p>
<p>OR指令对两个值进行逻辑或运算</p>
<p>这个指令会清空OF、CF标记，设置ZF标记</p>
<p>为了更好的理解OR，思考下面二进制串:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">10010101100101001101<br></code></pre></td></tr></table></figure>

<p>如果对它们进行逻辑与运算，结果将是1101011111。</p>
<p>只有当两边同为0时其结果为0，否则就为1。你可以用计算器尝试计算。希望你能理解为什么，最好自己动手算一算</p>
<p><strong>POP</strong></p>
<p>语法：POP 目的地址</p>
<p>POP指令将栈顶第一个字传送到目的地址。 每次POP后，ESP(栈指针寄存器)都会增加以指向新栈顶</p>
<p><strong>PUSH</strong></p>
<p>语法：PUSH 值</p>
<p>PUSH是POP的相反操作，它将一个值压入栈并且减小栈顶指针值以指向新栈顶。</p>
<p><strong>REP/REPE/REPZ/REPNE/REPNZ</strong></p>
<p>语法: REP/REPE/REPZ/REPNE/REPNZ ins</p>
<p>重复上面的指令：直到CX=0。ins必须是一个操作符，比如CMPS、INS、LODS、MOVS、OUTS、SCAS 或 STOS</p>
<p><strong>RET (return返回)</strong></p>
<p>语法：RET</p>
<p>RET digit</p>
<p>RET指令的功能是从一个代码区域中退出到调用CALL的指令处。</p>
<p>RET digit在返回前会清理栈</p>
<p><strong>SUB (减)</strong></p>
<p>语法：SUB 目的数,源数</p>
<p>SUB与ADD相反，它将源数减去目的数，并将结果储存在目的数中</p>
<p>SUB可以标记ZF、OF、CF</p>
<p><strong>TEST</strong></p>
<p>语法：TEST 操作符、操作符</p>
<p>这个指令99%都是用于”TEST EAX, EAX”，它执行与AND相同的功能，但是并不储存数据。如果EAX=0就会标记ZF，如果EAX不是0，就会清空ZF</p>
<p><strong>XOR</strong></p>
<p>语法：XOR 目的数,源数</p>
<p>XOR指令对两个数进行异或操作</p>
<p>这个指令清空OF、CF，但会标记ZF</p>
<p>为了更好的理解，思考下面的二进制串：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">1001010110</span><br><span class="hljs-number">0101001101</span><br></code></pre></td></tr></table></figure>

<p>如果异或它们，结果将是1100011011</p>
<p>如果两个值相等，则结果为0，否则为1。</p>
<p>很多情况下我们会使用”XOR EAX, EAX”，这个操作是将EAX赋值为0，因为当一个值异或其自身，就过都是0。你最好自己动手尝试下，这样可以帮助你理解得更好</p>
<h3 id="MOV"><a href="#MOV" class="headerlink" title="MOV"></a>MOV</h3><p>MOV AX , 2000H 将AX传给2000H</p>
<h3 id="逻辑操作符"><a href="#逻辑操作符" class="headerlink" title="逻辑操作符"></a>逻辑操作符</h3><img src="/2020/01/13/%E6%B1%87%E7%BC%96%E3%80%81%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%9F%BA%E7%A1%80/Snipaste_2019-08-12_22-36-43.jpg" srcset="/img/loading.gif" lazyload class="" title="Snipaste_2019-08-12_22-36-43">



<h2 id="MIPS汇编"><a href="#MIPS汇编" class="headerlink" title="MIPS汇编"></a>MIPS汇编</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/thoupin/p/4018455.html">link</a></p>
<p>xori 异或</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF/">CTF</a>
                    
                      <a class="hover-with-bg" href="/categories/CTF/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a>
                    
                  </div>
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/01/13/%E4%BD%BF%E7%94%A8docker%E4%B8%BApwn%E9%A2%98%E7%9B%AE%E6%90%AD%E9%85%8D%E7%8E%AF%E5%A2%83/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">使用docker为pwn题目搭配环境</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/01/13/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%A4%8D%E4%B9%A0/">
                        <span class="hidden-mobile">操作系统复习</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <script type="text/javascript">
    Fluid.utils.lazyComments('comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'mrbelieve128/mrbelieve128.github.io');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        浙ICP备19033044号
      </a>
    </span>
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
